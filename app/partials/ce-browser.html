<div class="ceBrowser">
<div class="row-fluid">
	<div class="span4">
		<div class="btn-group">
			<a class="btn dropdown-toggle" data-toggle="dropdown">
				Connect
				<span class="caret"></span>
			</a>
			<ul class="dropdown-menu">
				<li ng-repeat="service in services">
					<a ng-click="connect(service.name)">{{service.display_name}}</a>
				</li>
			</ul>
		</div>
	</div>
	<div class="span4">
		<div ce-trash></div>
	</div>
</div>
<div class="row-fluid">
	<div class="span4">
		<script type="text/ng-template" id="tree_item_renderer.html">
				<a ce-folder class="is-dir-true">{{file.name}}</a>
				<ul class="tree">
						<li ng-repeat="file in file.children | filter:{'is_dir':true}" ng-include="'tree_item_renderer.html'" onload="srv=srv"></li>
				</ul>
		</script>
		<ul class="tree">
			<li ng-repeat="(srvTreeK, srvTreeV) in tree">
				<a ce-folder ng-class="srvTreeK">{{ srvTreeK }}</a>
				<ul class="tree">
					<li ng-repeat="file in srvTreeV | filter:{'is_dir':true}" ng-include="'tree_item_renderer.html'" onload="srv=srvTreeK"></li>
				</ul>
			</li>
		</ul>
	</div>
	<div class="span8">
		<script type="text/ng-template" id="file_template.html"><!-- add ng-pattern -->
			<span ng-hide="renameOn">{{file.name}}</span>
			<input ng-show="renameOn" type="text" ng-model="newName" ng-init="newName=file.name" />
			<button ng-click="rename(newName)">rename</button>
			<button ng-click="delete()">delete</button>
			<a ng-hide="file.is_dir" ng-href="{{download()}}" download="{{file.name}}" target="blank">download</a> <!-- Won't work in FF20 if not same origin thus the blank target -->
			<button ng-click="copy()">Copy</button>
			<menu id="{{fileSrv+'/'+filePath}}" type="context">
				<menuitem onclick="alert('toto')" label="Delete"></menuitem> <!-- FIXME manage to make it work with ng-click ? -->
				<menuitem onclick="alert('tata')" label="Rename"></menuitem>
				<menuitem onclick="alert('titi')" label="Save as..."></menuitem>
			</menu>
		</script>
		<ul>
			<li ng-show="isLoggedin" class="upload"> <!--	show it only if drag and drop isn't available ? -->
				Télécharge un ou plusieurs fichiers: <div file-uploader></div> <div ce-mkdir-btn></div> <div ce-paste-btn></div>
			</li>
			<li ce-folder ng-init="setLinkToParent()" ng-hide="isRootPath()" class="is-dir-true">..</li>
<!-- FIXME <li ce-folder ce-file ng-repeat="file in files | orderBy:'is_dir':true" ng-class="getClass()" >{{file.name}}</li> -->
			<li ce-folder ce-file ng-repeat="file in files | filter:{'is_dir':true}" ng-class="getClass()" contextmenu={{fileSrv+filePath}} ng-include="'file_template.html'"></li>
			<li ce-file ng-repeat="file in files | filter:{'is_dir':false}" ng-class="getClass()" contextmenu={{fileSrv+'/'+filePath}} ng-include="'file_template.html'"></li>
			<li class="is-dir-true" ng-show="mkdirOn"><input type="text" ng-model="mkdirName" /><button ng-click="doMkdir(mkdirName)">valider</button></li>
		</ul>
	</div>
</div>
<div class="row-fluid"><div class="span12" ce-console></div></div>
</div>